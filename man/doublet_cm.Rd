% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiplet_detection.R
\name{doublet_cm}
\alias{doublet_cm}
\title{Estimate Doublet Classification Using Central Matching and FDR Thresholding}
\usage{
doublet_cm(
  dat,
  truncation_point = 0,
  pct0 = c(0.2, 0.6),
  nulltype = 2,
  thres = 0.2
)
}
\arguments{
\item{dat}{A data frame containing at least the following columns:
- `obs`: Observed values to be analyzed.
- `label`: Ground truth labels ("Singlet" or "Doublet").
- `barcode`: Unique cell identifiers.}

\item{truncation_point}{Numeric. The threshold below which cells are automatically labeled as "Singlet". Default is `0`.}

\item{pct0}{Numeric vector of length 2. The lower and upper quantiles used for null distribution estimation. Default is `c(0.2, 0.6)`.}

\item{nulltype}{Integer. The type of null estimation model to use:
- `2`: Symmetric model.
- `3`: Asymmetric model allowing different variance estimates for left and right tails.}

\item{thres}{Numeric. FDR threshold for doublet classification. Default is `0.2`.}
}
\value{
A list containing:
  - `result`: A data frame with the original data and additional columns:
      - `box.cox.obs.truncated`: Transformed observations.
      - `cm.FDR.truncated`: Computed FDR values.
      - `cm.label.truncated`: Predicted classification ("Doublet" or "Singlet").
      - `cm.lfdr.truncated`: Local FDR estimates.
  - Additional parameters used in the estimation.
}
\description{
This function performs doublet detection on a dataset by applying Box-Cox transformation,
estimating null distributions, computing False Discovery Rate (FDR), and classifying
cells as "Doublet" or "Singlet" based on a specified threshold.
}
